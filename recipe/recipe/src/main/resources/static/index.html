<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>레시피 애플리케이션 테스트</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .section {
            margin-bottom: 40px;
        }
        label {
            display: block;
            margin-top: 10px;
        }
        input, textarea, select {
            width: 300px;
            padding: 5px;
            margin-top: 5px;
        }
        button {
            margin-top: 10px;
            padding: 10px 20px;
        }
        .response {
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            max-width: 600px;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
<h1>레시피 애플리케이션 테스트 페이지</h1>

<div class="section" id="user-section">
    <h2>사용자 추가</h2>
    <form id="add-user-form">
        <label for="userId">사용자 ID:</label>
        <input type="text" id="userId" name="userId" required>

        <label for="userName">닉네임:</label>
        <input type="text" id="userName" name="userName" required>

        <label for="email">이메일:</label>
        <input type="email" id="email" name="email" required>

        <label for="password">비밀번호:</label>
        <input type="password" id="password" name="password" required>

        <label for="phone">전화번호:</label>
        <input type="text" id="phone" name="phone">

        <label for="grade">등급:</label>
        <select id="grade" name="grade">
            <option value="Bronze">Bronze</option>
            <option value="Silver">Silver</option>
            <option value="Gold">Gold</option>
        </select>

        <button type="submit">사용자 추가</button>
    </form>
    <div class="response" id="add-user-response"></div>
</div>

<div class="section" id="recipe-section">
    <h2>레시피 추가</h2>
    <form id="add-recipe-form">
        <label for="recipeUserId">작성자 ID:</label>
        <input type="text" id="recipeUserId" name="userId" required>

        <label for="title">제목:</label>
        <input type="text" id="title" name="title" required>

        <label for="description">설명:</label>
        <textarea id="description" name="description" required></textarea>

        <label for="ingredients">재료:</label>
        <textarea id="ingredients" name="ingredients" required></textarea>

        <label for="category">카테고리:</label>
        <input type="text" id="category" name="category" required>

        <button type="submit">레시피 추가</button>
    </form>
    <div class="response" id="add-recipe-response"></div>
</div>

<div class="section" id="get-recipes-section">
    <h2>모든 레시피 조회</h2>
    <button id="get-all-recipes">레시피 가져오기</button>
    <div class="response" id="get-all-recipes-response"></div>
</div>

<div class="section" id="bookmark-section">
    <h2>북마크 추가</h2>
    <form id="add-bookmark-form">
        <label for="bookmarkUserId">사용자 ID:</label>
        <input type="text" id="bookmarkUserId" name="userId" required>

        <label for="bookmarkRecipeId">레시피 ID:</label>
        <input type="number" id="bookmarkRecipeId" name="recipeId" required>

        <button type="submit">북마크 추가</button>
    </form>
    <div class="response" id="add-bookmark-response"></div>
</div>

<div class="section" id="get-bookmarks-section">
    <h2>사용자 북마크 조회</h2>
    <form id="get-bookmarks-form">
        <label for="getBookmarksUserId">사용자 ID:</label>
        <input type="text" id="getBookmarksUserId" name="userId" required>

        <button type="submit">북마크 조회</button>
    </form>
    <div class="response" id="get-bookmarks-response"></div>
</div>

<script>
    const apiBase = '/api';

    // 사용자 추가
    document.getElementById('add-user-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const user = {
            userId: document.getElementById('userId').value,
            userName: document.getElementById('userName').value,
            email: document.getElementById('email').value,
            password: document.getElementById('password').value,
            phone: document.getElementById('phone').value,
            grade: document.getElementById('grade').value
        };

        try {
            const response = await fetch(`${apiBase}/users/${user.userId}`, {
                method: 'PUT', // 사용자 업데이트 또는 생성
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(user)
            });

            if (response.ok) {
                const data = await response.json();
                document.getElementById('add-user-response').innerText = `사용자 추가 성공: ${JSON.stringify(data)}`;
            } else {
                const error = await response.text();
                document.getElementById('add-user-response').innerText = `에러: ${error}`;
            }
        } catch (error) {
            document.getElementById('add-user-response').innerText = `예외 발생: ${error}`;
        }
    });

    // 레시피 추가
    document.getElementById('add-recipe-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const recipe = {
            user: { userId: document.getElementById('recipeUserId').value },
            title: document.getElementById('title').value,
            description: document.getElementById('description').value,
            ingredients: document.getElementById('ingredients').value,
            category: document.getElementById('category').value
        };

        try {
            const response = await fetch(`${apiBase}/recipes`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(recipe)
            });

            if (response.ok) {
                const data = await response.json();
                document.getElementById('add-recipe-response').innerText = `레시피 추가 성공: ${JSON.stringify(data)}`;
            } else {
                const error = await response.text();
                document.getElementById('add-recipe-response').innerText = `에러: ${error}`;
            }
        } catch (error) {
            document.getElementById('add-recipe-response').innerText = `예외 발생: ${error}`;
        }
    });

    // 모든 레시피 가져오기
    document.getElementById('get-all-recipes').addEventListener('click', async () => {
        try {
            const response = await fetch(`${apiBase}/recipes`);
            if (response.ok) {
                const data = await response.json();
                document.getElementById('get-all-recipes-response').innerText = `레시피 목록: ${JSON.stringify(data, null, 2)}`;
            } else {
                const error = await response.text();
                document.getElementById('get-all-recipes-response').innerText = `에러: ${error}`;
            }
        } catch (error) {
            document.getElementById('get-all-recipes-response').innerText = `예외 발생: ${error}`;
        }
    });

    // 북마크 추가
    document.getElementById('add-bookmark-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const bookmark = {
            user: { userId: document.getElementById('bookmarkUserId').value },
            recipe: { recipeId: parseInt(document.getElementById('bookmarkRecipeId').value) }
        };

        try {
            const response = await fetch(`${apiBase}/bookmarks`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(bookmark)
            });

            if (response.status === 201) { // CREATED 상태 코드 확인
                const data = await response.json();
                document.getElementById('add-bookmark-response').innerText = `북마크 추가 성공: ${JSON.stringify(data)}`;
            } else {
                const error = await response.text();
                document.getElementById('add-bookmark-response').innerText = `에러: ${error}`;
            }
        } catch (error) {
            document.getElementById('add-bookmark-response').innerText = `예외 발생: ${error}`;
        }
    });


    // 사용자 북마크 조회
    document.getElementById('get-bookmarks-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const userId = document.getElementById('getBookmarksUserId').value;

        try {
            const response = await fetch(`${apiBase}/bookmarks/${userId}`);
            if (response.ok) {
                const data = await response.json();
                document.getElementById('get-bookmarks-response').innerText = `북마크 목록: ${JSON.stringify(data, null, 2)}`;
            } else {
                const error = await response.text();
                document.getElementById('get-bookmarks-response').innerText = `에러: ${error}`;
            }
        } catch (error) {
            document.getElementById('get-bookmarks-response').innerText = `예외 발생: ${error}`;
        }
    });
</script>
</body>
</html>
